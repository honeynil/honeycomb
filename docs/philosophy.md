# Философия Go: Почему простота важна

> "Сложность — враг надёжности"
> — **Rob Pike**, сооснователь Go

---

## Оглавление

- [Три столпа философии Go](#три-столпа-философии-go)
- [Как это влияет на структуру проектов](#как-это-влияет-на-структуру-проектов)
- [Go Proverbs](#go-proverbs)
- [Примеры из практики](#примеры-из-практики)

---

## Три столпа философии Go

### 1. Start Simple

**Принцип:** Начинай с минимально работающего решения.

```go
// начни с этого
package main

func main() {
    println("Hello, honey!")
}
```

```go
// не начинай с этого
project/
├── cmd/
├── internal/
│   ├── domain/
│   ├── application/
│   ├── infrastructure/
│   └── interfaces/
├── pkg/
└── ...ещё 10 папок
```

**Почему это важно:**
- Ты **не знаешь**, каким будет проект через год
- Преждевременная оптимизация структуры == потерянное время
- Легче добавить сложность, чем убрать лишнее

---

### 2. Grow Naturally

**Принцип:** Структура эволюционирует вместе с кодом, а не создаётся заранее.

#### Эволюция проекта:

**Стадия 1: Прототип**
```
todo-cli/
├── go.mod
└── main.go    # 100 строк
```
*Триггер для следующей стадии:* логика смешивается, кодовая база растёт

---

**Стадия 2: Разделение логики**
```
todo-cli/
├── go.mod
├── main.go      # CLI интерфейс
├── task.go      # Модель задачи
└── storage.go   # Сохранение в файл
```
*Триггер для следующей стадии:* хочется скрыть внутренности, кодовая база растёт.

---

**Стадия 3: Приватные пакеты**
```
todo-cli/
├── go.mod
├── main.go
└── internal/
    ├── task/
    │   ├── task.go
    │   └── list.go
    └── storage/
        ├── file.go
        └── json.go
```
*Триггер для следующей стадии:* Добавляется веб-версия, нужен второй executable файл.

---

**Стадия 4: Несколько приложений**
```
todo-app/
├── go.mod
├── cmd/
│   ├── cli/main.go
│   └── server/main.go
└── internal/
    ├── task/
    └── storage/
```

**Каждая стадия решает конкретную проблему.** Не прыгай сразу к стадии 4.

---

### 3. Clear is Better than Clever

**Принцип:** Код должен быть понятным, а не "умным".

#### Пример 1: Именование

```go
// "Умно": абстракция ради абстракции
type AbstractFactoryProducerInterface interface {
    CreateFactory() FactoryInterface
}

// Ясно: понятно что делает
type UserRepository interface {
    GetByID(id string) (*User, error)
}
```

#### Пример 2: Структура

```go
// "Умно": сложная иерархия
domain/
  entities/
    user/
      models/
        user_entity.go
  repositories/
    interfaces/
      user_repository_interface.go
    implementations/
      postgres/
        user_repository_impl.go

// Ясно: плоская структура
internal/
  user/
    user.go        # Entity
    repository.go  # Интерфейс здесь, где используется.
    postgres.go    # Реализация
```

**Ясность важнее:**
- Код читают в 10 раз чаще, чем пишут
- Новый разработчик должен быстро разобраться
- Поддержка через год — это ваша проблема

---

### Цели создателей (Rob Pike, Ken Thompson, Robert Griesemer):

1. **Быстрая компиляция** → меньше абстракций
2. **Простота чтения** → явное лучше неявного
3. **Легкость поддержки** → нет "магии"

### Цитаты создателей:

> "Go — это попытка объединить лёгкость программирования на интерпретируемом языке с эффективностью компилируемого."
> — **Rob Pike**

> "Меньше — это экспоненциально больше."
> — **Rob Pike**, Less is Exponentially More

> "Сложность множится. Каждая новая фича добавляет не одну проблему, а десятки."
> — **Russ Cox**

---

## Как это влияет на структуру проектов

### Стандартная библиотека — наш лучший учитель

Go stdlib организован **по функциональности**, а не по типам:

```
Идиоматично (как в stdlib):
go/src/
├── net/           # функциональность: сетевое взаимодействие
│   ├── http/      # HTTP протокол
│   ├── smtp/      # SMTP протокол
│   └── url/       # Работа с URL
├── encoding/      # функциональность: кодирование
│   ├── json/
│   ├── xml/
│   └── base64/
└── database/
    └── sql/
```
---

### Принцип "Пакет = Функциональность"

```go
// Правильно: пакет знает свою ответственность
package user

type User struct { ... }
type Repository interface { ... }
type Service struct { ... }

func (s *Service) Create(u *User) error { ... }
```

```go
// Неправильно: пакеты без чёткой ответственности
package models  // что это моделирует?

type User struct { ... }
type Order struct { ... }
type Payment struct { ... }  // почему всё в одном пакете?
```

**Задай себе вопрос:** Можете описать одним предложением, что делает пакет?
- ✅ `package user` — управляет пользователями
- ❌ `package models` — содержит... модели? каких сущностей?

---

## Go Proverbs

- **Go Proverbs** — полезно знать эти принципы.
- Ключевые принципы от создателей языка. Помогают писать идиоматичный и понятный код.

**Полный список:** [go-proverbs.github.io](https://go-proverbs.github.io)

---

## Примеры из практики

### Пример 1: Kubernetes (плохой пример структуры)

**Почему?** Проект начинался на Java, затем портирован на Go.

**Проблемы:**
- `/pkg` используется для приватного кода (не идиоматично)
- Исторический багаж Java-архитектуры

**Так что:** Популярность проекта != идиоматичная структура.

---

### Пример 2: Traefik (хороший пример)

```
traefik/
├── cmd/traefik/
├── pkg/
│   ├── config/      # конфигурация
│   ├── middlewares/ # middleware'ы
│   ├── server/      # HTTP сервер
│   └── provider/    # провайдеры (Docker, K8s)
└── integration/
```

**Плюсы:**
- Пакеты по функциональности
- `/pkg` для переиспользуемого кода (правильное применение)

---

## Запомни:

1. **Простота — не примитивность**
   - Простое решение может быть элегантным
   - Сложность должна быть обоснованной

2. **Эволюция лучше революции**
   - Не создавай структуру заранее
   - Добавляй по мере роста

3. **Читаемость > Абстракция**
   - Код читают чаще, чем пишут
   - Ясность важнее "правильной" архитектуры

4. **Контекст важен**
   - Нет универсального решения
   - Решай свою проблему

---

## Ресурсы

- [Less is Exponentially More](https://commandcenter.blogspot.com/2012/06/less-is-exponentially-more.html) — Rob Pike
- [Go Proverbs](https://go-proverbs.github.io) — Rob Pike
- [Simplicity is Complicated](https://www.youtube.com/watch?v=rFejpH_tAHM) — Rob Pike (видео)
- [Effective Go](https://go.dev/doc/effective_go) — официальная документация

---

**Помни:** Философия Go — это не догма, а набор принципов, которые помогают писать поддерживаемый код.
